{% extends "base.html" %}
{% load static %}
<!-- templates/catalog.html -->
{% block content %}

<div class="d-flex align-items-end justify-content-between gap-3 flex-wrap mb-3">
    <div>
        <h2 class="fw-bold mb-0 text-capitalize">{{ category }}</h2>
        <div class="text-muted small">–ó–Ω–∞–π–¥–µ–Ω–æ: {{ count }}</div>
    </div>

    <form class="d-flex gap-2" method="get">
        <input class="form-control" name="q" placeholder="–ü–æ—à—É–∫ –ø–æ –Ω–∞–∑–≤—ñ‚Ä¶" value="{{ selected.q }}">
        <select class="form-select" name="sort">
            <option value="default" {% if selected.sort == 
            'default' %}selected{% endif %}>–°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è</option>
            <option value="price_asc" {% if selected.sort == 
            'price_asc' %}selected{% endif %}>–¶—ñ–Ω–∞ ‚Üë</option>
            <option value="price_desc" {% if selected.sort == 
            'price_desc' %}selected{% endif %}>–¶—ñ–Ω–∞ ‚Üì</option>
            <option value="name" {% if selected.sort == 
            'name' %}selected{% endif %}>–ù–∞–∑–≤–∞ (A‚ÜíZ)</option>
        </select>
        <button class="btn btn-dark">OK</button>
    </form>
</div>

<div class="row g-3">
    <!-- FILTERS -->
    <div class="col-12 col-lg-3">
        <div class="card rounded-4 p-3">
            <form method="get">
                <div class="fw-bold mb-2">–§—ñ–ª—å—Ç—Ä–∏</div>

                <label class="form-label small">–ü–æ—à—É–∫</label>
                <input class="form-control mb-3" name="q" value="{{ selected.q }}" placeholder="–ù–∞–ø—Ä. Burton">

                <div class="row g-2 mb-3">
                    <div class="col-6">
                        <label class="form-label small">Min $</label>
                        <input class="form-control" name="min_price" value="{{ selected.min_price }}">
                    </div>
                    <div class="col-6">
                        <label class="form-label small">Max $</label>
                        <input class="form-control" name="max_price" value="{{ selected.max_price }}">
                    </div>
                </div>

                <label class="form-label small">Brand</label>
                <div class="mb-3">
                    {% for b in filters.brands %}
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" name="brand" value="{{ b }}"
                               {% if b in selected.brand %}checked{% endif %}>
                        <label class="form-check-label">{{ b }}</label>
                    </div>
                    {% endfor %}
                </div>

                <label class="form-label small">Level</label>
                <div class="mb-3">
                    {% for l in filters.levels %}
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" name="level" value="{{ l }}"
                               {% if l in selected.level %}checked{% endif %}>
                        <label class="form-check-label">{{ l }}</label>
                    </div>
                    {% endfor %}
                </div>

                <label class="form-label small">Style</label>
                <div class="mb-3">
                    {% for s in filters.styles %}
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" name="style" value="{{ s }}"
                               {% if s in selected.style %}checked{% endif %}>
                        <label class="form-check-label">{{ s }}</label>
                    </div>
                    {% endfor %}
                </div>

                <label class="form-label small">Sort</label>
                <select class="form-select mb-3" name="sort">
                    <option value="default" {% if selected.sort == 
                    'default' %}selected{% endif %}>‚Äî</option>
                    <option value="price_asc" {% if selected.sort == 
                    'price_asc' %}selected{% endif %}>–¶—ñ–Ω–∞ ‚Üë</option>
                    <option value="price_desc" {% if selected.sort == 
                    'price_desc' %}selected{% endif %}>–¶—ñ–Ω–∞ ‚Üì</option>
                    <option value="name" {% if selected.sort == 
                    'name' %} selected{% endif %}>–ù–∞–∑–≤–∞</option>
                </select>

                <div class="d-flex gap-2">
                    <button class="btn btn-dark w-100">–ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏</button>
                    <a class="btn btn-outline-secondary w-100" href="{{ request.path }}">–°–∫–∏–Ω—É—Ç–∏</a>
                </div>
            </form>
        </div>
    </div>


    <!-- PRODUCTS GRID -->
    <div class="col-12 col-lg-9">
        <div class="row g-3">
            {% for p in products %}
            <div class="col-12 col-md-6 col-xl-4">
                <div class="card rounded-4 h-100">
                    <img src="{% static p.image %}" alt="{{ p.name }}">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-start gap-2">
                            <div class="fw-bold">{{ p.name }}</div>
                            <div class="d-flex gap-1">
                                {% if p.is_new %}<span class="badge text-bg-success">NEW</span>{% endif %}
                                {% if p.is_sale %}<span class="badge text-bg-danger">SALE</span>{% endif %}
                            </div>
                        </div>
                        <div class="text-muted small">{{ p.brand }} ‚Ä¢ {{ p.level }} ‚Ä¢ {{ p.style }}</div>
                        <div class="mt-2 fw-bold">${{ p.price }}</div>
                        <a class="btn btn-sm btn-outline-dark mt-2" href="{% url 'product_page' p.id %}">
                            –í—ñ–¥–∫—Ä–∏—Ç–∏ ‚ûú
                        </a>
                        <a href="{% url 'add_to_cart' p.id %}"
                           class="add-to-cart-btn">
                            –í –∫–æ—Ä–∑–∏–Ω—É
                        </a>

                    </div>
                </div>
            </div>
            {% endfor %}

            {% if products|length == 0 %}
            <div class="col-12">
                <div class="alert alert-warning rounded-4">
                    –ù—ñ—á–æ–≥–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ üòÖ –°–ø—Ä–æ–±—É–π –∑–º—ñ–Ω–∏—Ç–∏ —Ñ—ñ–ª—å—Ç—Ä–∏.
                </div>
            </div>
            {% endif %}
        </div>
    </div>
</div>

{% endblock %}